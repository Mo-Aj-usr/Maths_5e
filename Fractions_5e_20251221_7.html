<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Maths 5e – QCM Fractions (20 questions)</title>

  <!-- MathJax -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root {
      --c-primary: #3f51b5;
      --c-secondary: #ff9800;
      --c-good: #4caf50;
      --c-bad: #f44336;
      --c-bg: #f4f7ff;
      --c-card: #ffffff;
      --c-muted: #666;
    }

    body {
      margin: 0;
      font-family: "Segoe UI", system-ui, sans-serif;
      background: radial-gradient(circle at top left, #e3f2fd, #fce4ec 60%, #f4f7ff);
      padding: 20px;
    }

    .app {
      max-width: 1100px;
      margin: auto;
      background: var(--c-card);
      border-radius: 18px;
      padding: 30px;
      box-shadow: 0 16px 40px rgba(0,0,0,0.15);
    }

    h1 {
      color: var(--c-primary);
      margin-bottom: 10px;
    }

    .subtitle {
      color: var(--c-muted);
      margin-bottom: 20px;
    }

    .progress-track {
      height: 12px;
      background: #e0e7ff;
      border-radius: 999px;
      overflow: hidden;
      margin-bottom: 8px;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--c-primary), var(--c-secondary));
      transition: width 0.4s;
    }

    .progress-info {
      display: flex;
      justify-content: space-between;
      font-size: 0.9rem;
      color: var(--c-muted);
    }

    .question-block {
      background: #f8f9ff;
      border: 1px solid #e0e7ff;
      border-radius: 16px;
      padding: 20px;
      margin: 25px 0;
    }

    .question-title {
      font-weight: 600;
      color: #1a237e;
      margin-bottom: 10px;
    }

    .meta {
      font-size: 0.8rem;
      color: var(--c-muted);
      margin-bottom: 12px;
    }

    .answers {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 10px;
    }

    .answer input { display: none; }

    .answer label {
      display: flex;
      gap: 10px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #d1d9ff;
      background: #fff;
      cursor: pointer;
      transition: 0.2s;
    }

    .answer input:checked + label {
      background: #e8eaf6;
      border-color: var(--c-primary);
    }

    .bullet {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid #c5cae9;
      margin-top: 2px;
    }

    .answer input:checked + label .bullet {
      background: var(--c-primary);
      border-color: var(--c-primary);
    }

    .feedback {
      margin-top: 10px;
      font-weight: 500;
    }

    .good { color: var(--c-good); }
    .bad { color: var(--c-bad); }

    .correct-btn {
      margin-top: 12px;
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: var(--c-primary);
      color: white;
      cursor: pointer;
    }

    .indexes {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin: 30px 0;
    }

    .idx {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 1px solid #c5cae9;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .idx.correct { background: var(--c-good); color: white; }
    .idx.wrong { background: var(--c-bad); color: white; }

    .score {
      text-align: center;
      font-size: 1.4rem;
      color: var(--c-primary);
      margin: 20px 0;
    }
  </style>
</head>
<body>

<div class="app">
  <h1>Maths 5e – QCM Fractions</h1>
  <p class="subtitle">20 questions – programme officiel EduScol – niveau confirmé</p>

  <div class="progress-track"><div id="progressFill" class="progress-fill"></div></div>
  <div class="progress-info">
    <span id="answeredText">0 question répondue</span>
    <span id="scoreText">Score : 0 / 20</span>
  </div>

  <div class="score" id="scoreFinal">Score final : 0 / 20</div>

  <div class="indexes" id="indexes"></div>
  <div id="questions"></div>
</div>

<script>
const questions = [
  {
    text: "Quelle écriture décimale correspond à \\(\\dfrac{23}{10}\\) ?",
    options: ["2,3", "0,23", "23,0", "2,03"],
    correct: 0,
    good: "23 ÷ 10 = 2,3.",
    bad: "Diviser par 10 décale la virgule d’un rang vers la gauche."
  },
  {
    text: "Quelle fraction est égale à 0,75 ?",
    options: ["\\(\\dfrac{3}{4}\\)", "\\(\\dfrac{75}{10}\\)", "\\(\\dfrac{7}{5}\\)", "\\(\\dfrac{4}{3}\\)"],
    correct: 0,
    good: "0,75 = 75/100 = 3/4.",
    bad: "Écris 0,75 sous forme fractionnaire puis simplifie."
  },
  {
    text: "Simplifie la fraction \\(\\dfrac{18}{24}\\).",
    options: ["\\(\\dfrac{3}{4}\\)", "\\(\\dfrac{2}{3}\\)", "\\(\\dfrac{9}{12}\\)", "\\(\\dfrac{6}{8}\\)"],
    correct: 0,
    good: "18 et 24 sont divisibles par 6.",
    bad: "Cherche le plus grand diviseur commun."
  },
  {
    text: "Quelle est la plus grande fraction ?",
    options: ["\\(\\dfrac{3}{5}\\)", "\\(\\dfrac{4}{7}\\)", "\\(\\dfrac{5}{9}\\)", "\\(\\dfrac{2}{3}\\)"],
    correct: 3,
    good: "2/3 ≈ 0,67 est la plus grande.",
    bad: "Compare les valeurs décimales."
  },
  {
    text: "Calcule : \\(\\dfrac{5}{6}+\\dfrac{1}{6}\\)",
    options: ["\\(\\dfrac{1}{2}\\)", "\\(\\dfrac{6}{6}\\)", "\\(\\dfrac{5}{12}\\)", "\\(\\dfrac{1}{6}\\)"],
    correct: 1,
    good: "5 + 1 = 6 donc 6/6.",
    bad: "Les dénominateurs sont déjà égaux."
  },
  {
    text: "Calcule : \\(\\dfrac{2}{3}+\\dfrac{1}{6}\\)",
    options: ["\\(\\dfrac{3}{6}\\)", "\\(\\dfrac{5}{6}\\)", "\\(\\dfrac{2}{9}\\)", "\\(\\dfrac{1}{2}\\)"],
    correct: 1,
    good: "2/3 = 4/6 → 4/6 + 1/6 = 5/6.",
    bad: "Commence par mettre au même dénominateur."
  },
  {
    text: "Calcule 20 % de 45 €.",
    options: ["9 €", "90 €", "4,5 €", "0,9 €"],
    correct: 0,
    good: "0,2 × 45 = 9.",
    bad: "20 % = 0,2."
  },
  {
    text: "Un élève lit \\(\\dfrac{3}{5}\\) de 200 pages. Combien a-t-il lu ?",
    options: ["80", "100", "120", "60"],
    correct: 2,
    good: "3/5 de 200 = 120.",
    bad: "Commence par calculer 1/5."
  }
];

// État
const answers = new Array(questions.length).fill(null);
const checked = new Array(questions.length).fill(false);

const qDiv = document.getElementById("questions");
const progressFill = document.getElementById("progressFill");
const answeredText = document.getElementById("answeredText");
const scoreText = document.getElementById("scoreText");
const scoreFinal = document.getElementById("scoreFinal");
const indexes = document.getElementById("indexes");

function updateGlobal() {
  const answered = answers.filter(a => a !== null).length;
  const score = answers.reduce((s,a,i)=> checked[i] && a===questions[i].correct ? s+1 : s,0);

  progressFill.style.width = (answered/questions.length*100)+"%";
  answeredText.textContent = `${answered} question(s) répondue(s)`;
  scoreText.textContent = `Score : ${score} / ${questions.length}`;
  scoreFinal.textContent = `Score final : ${score} / ${questions.length}`;

  indexes.innerHTML = "";
  questions.forEach((_,i)=>{
    const d=document.createElement("div");
    d.className="idx";
    d.textContent=i+1;
    if(checked[i]) d.classList.add(answers[i]===questions[i].correct?"correct":"wrong");
    d.onclick=()=>document.getElementById("q"+i).scrollIntoView({behavior:"smooth"});
    indexes.appendChild(d);
  });
}

questions.forEach((q,i)=>{
  const block=document.createElement("div");
  block.className="question-block";
  block.id="q"+i;
  block.innerHTML=`<div class="question-title">${i+1}. ${q.text}</div>
    <div class="answers"></div>
    <div class="feedback"></div>`;

  const answersDiv=block.querySelector(".answers");
  const fb=block.querySelector(".feedback");

  q.options.forEach((opt,j)=>{
    const a=document.createElement("div");
    a.className="answer";
    a.innerHTML=`<input type="radio" name="q${i}" id="q${i}_${j}">
    <label for="q${i}_${j}"><div class="bullet"></div><div>${opt}</div></label>`;
    a.querySelector("input").onchange=()=>{
      answers[i]=j; checked[i]=false; fb.textContent=""; updateGlobal();
    };
    answersDiv.appendChild(a);
  });

  const btn=document.createElement("button");
  btn.className="correct-btn";
  btn.textContent="Corriger";
  btn.onclick=()=>{
    if(answers[i]==null){fb.textContent="Choisis une réponse."; fb.className="feedback bad"; return;}
    checked[i]=true;
    fb.textContent=answers[i]===q.correct?q.good:q.bad;
    fb.className="feedback "+(answers[i]===q.correct?"good":"bad");
    updateGlobal();
  };
  block.appendChild(btn);
  qDiv.appendChild(block);
});

MathJax.typesetPromise();
updateGlobal();
</script>
</body>
</html>
